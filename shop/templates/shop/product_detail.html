{% extends 'shop/base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{{ product.name }} - Amazon Bloque{% endblock %}

{% block extra_css %}
<style>
    .product-detail-container {
        max-width: 1500px;
        margin: 20px auto;
        background: white;
        border-radius: 8px;
        padding: 30px;
    }

    .breadcrumb {
        font-size: 12px;
        color: #565959;
        margin-bottom: 20px;
    }

    .breadcrumb a {
        color: #007185;
        text-decoration: none;
    }

    .breadcrumb a:hover {
        color: #c7511f;
        text-decoration: underline;
    }

    .product-main {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 30px;
        margin-bottom: 40px;
    }

    .product-image-section {
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .product-main-image {
        width: 100%;
        max-width: 500px;
        height: 500px;
        object-fit: cover;
        border-radius: 8px;
        border: 1px solid #ddd;
        margin-bottom: 15px;
    }

    .product-info-section {
        padding: 0 20px;
    }

    .product-category-badge {
        display: inline-block;
        background-color: #f0f2f2;
        color: #007185;
        padding: 5px 12px;
        border-radius: 4px;
        font-size: 13px;
        margin-bottom: 10px;
        text-decoration: none;
    }

    .product-category-badge:hover {
        background-color: #e3e6e6;
    }

    .product-detail-title {
        font-size: 28px;
        font-weight: 400;
        line-height: 1.3;
        color: #0f1111;
        margin-bottom: 10px;
    }

    .product-detail-rating {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 15px;
        font-size: 14px;
    }

    .rating-stars {
        color: #ffa41c;
        font-size: 16px;
    }

    .rating-number {
        color: #007185;
        margin-left: 5px;
    }

    .rating-count {
        color: #007185;
    }

    .rating-count:hover {
        color: #c7511f;
        text-decoration: underline;
        cursor: pointer;
    }

    .divider {
        height: 1px;
        background-color: #e7e7e7;
        margin: 20px 0;
    }

    .product-detail-price {
        margin-bottom: 20px;
    }

    .price-label {
        font-size: 14px;
        color: #565959;
        margin-bottom: 5px;
    }

    .current-price {
        font-size: 32px;
        color: #b12704;
        font-weight: 400;
        display: flex;
        align-items: baseline;
        gap: 10px;
    }

    .price-symbol {
        font-size: 18px;
        vertical-align: super;
    }

    .original-price-detail {
        font-size: 16px;
        color: #565959;
        text-decoration: line-through;
        margin-left: 10px;
    }

    .savings-badge {
        display: inline-block;
        background-color: #cc0c39;
        color: white;
        padding: 4px 10px;
        border-radius: 4px;
        font-size: 14px;
        font-weight: 500;
        margin-left: 10px;
    }

    .prime-section {
        background-color: #f7fafa;
        border: 1px solid #d5dbdb;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 20px;
    }

    .prime-logo {
        color: #00a8e1;
        font-size: 20px;
        font-weight: bold;
        display: flex;
        align-items: center;
        gap: 5px;
        margin-bottom: 10px;
    }

    .prime-benefits {
        font-size: 14px;
        color: #0f1111;
        line-height: 1.6;
    }

    .product-description {
        margin-bottom: 25px;
    }

    .description-title {
        font-size: 16px;
        font-weight: 700;
        margin-bottom: 10px;
        color: #0f1111;
    }

    .description-text {
        font-size: 14px;
        line-height: 1.6;
        color: #0f1111;
    }

    .product-features {
        margin-bottom: 25px;
    }

    .features-list {
        list-style: none;
        padding: 0;
    }

    .features-list li {
        padding: 8px 0;
        font-size: 14px;
        color: #0f1111;
        display: flex;
        align-items: start;
    }

    .features-list li:before {
        content: "✓";
        color: #067d62;
        font-weight: bold;
        margin-right: 10px;
        font-size: 16px;
    }

    .buy-box {
        background-color: white;
        border: 1px solid #d5d9d9;
        border-radius: 8px;
        padding: 20px;
        position: sticky;
        top: 20px;
    }

    .buy-box-price {
        font-size: 28px;
        color: #0f1111;
        margin-bottom: 15px;
    }

    .stock-status {
        font-size: 18px;
        margin-bottom: 15px;
    }

    .in-stock {
        color: #007600;
    }

    .out-of-stock {
        color: #b12704;
    }

    .delivery-info {
        background-color: #f7fafa;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 20px;
        font-size: 14px;
    }

    .delivery-info strong {
        color: #0f1111;
    }

    .quantity-selector {
        margin-bottom: 15px;
    }

    .quantity-selector label {
        display: block;
        font-size: 14px;
        font-weight: 700;
        margin-bottom: 5px;
    }

    .quantity-selector select {
        padding: 8px 40px 8px 12px;
        border: 1px solid #d5d9d9;
        border-radius: 8px;
        font-size: 14px;
        background-color: #f0f2f2;
        cursor: pointer;
        box-shadow: 0 2px 5px 0 rgba(213,217,217,.5);
    }

    .btn-add-cart {
        width: 100%;
        background-color: #ffd814;
        border: 1px solid #fcd200;
        border-radius: 8px;
        padding: 12px;
        font-size: 15px;
        cursor: pointer;
        transition: background-color 0.2s;
        margin-bottom: 10px;
    }

    .btn-add-cart:hover {
        background-color: #f7ca00;
    }

    .btn-buy-now {
        width: 100%;
        background-color: #ffa41c;
        border: 1px solid #ff8f00;
        border-radius: 8px;
        padding: 12px;
        font-size: 15px;
        cursor: pointer;
        transition: background-color 0.2s;
    }

    .btn-buy-now:hover {
        background-color: #fa8900;
    }

    .related-products-section {
        margin-top: 40px;
        padding-top: 30px;
        border-top: 1px solid #e7e7e7;
    }

    .related-title {
        font-size: 24px;
        font-weight: 700;
        margin-bottom: 20px;
        color: #0f1111;
    }

    .related-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 20px;
    }

    .related-product-card {
        background: white;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 15px;
        text-decoration: none;
        color: inherit;
        transition: transform 0.2s, box-shadow 0.2s;
    }

    .related-product-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    .related-product-image {
        width: 100%;
        height: 180px;
        object-fit: cover;
        border-radius: 4px;
        margin-bottom: 10px;
    }

    .related-product-name {
        font-size: 14px;
        font-weight: 500;
        margin-bottom: 8px;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }

    .related-product-price {
        font-size: 18px;
        font-weight: 700;
        color: #b12704;
    }

    @media (max-width: 1024px) {
        .product-main {
            grid-template-columns: 1fr 1fr;
        }
        
        .buy-box {
            position: static;
        }
    }

    @media (max-width: 768px) {
        .product-main {
            grid-template-columns: 1fr;
        }

        .product-detail-container {
            padding: 15px;
        }

        .product-detail-title {
            font-size: 22px;
        }

        .current-price {
            font-size: 24px;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="product-detail-container">
    <!-- Breadcrumb -->
    <div class="breadcrumb">
        <a href="{% url 'shop:index' %}">{% trans "Inicio" %}</a>
        <span> › </span>
        <a href="#">{{ product.category.name }}</a>
        <span> › </span>
        <span>{{ product.name }}</span>
    </div>

    <!-- Producto Principal -->
    <div class="product-main">
        <!-- Imagen del Producto -->
        <div class="product-image-section">
            <img src="{% if product.image %}{{ product.image.url }}{% else %}https://via.placeholder.com/500{% endif %}" 
                 alt="{{ product.name }}" 
                 class="product-main-image"
                 onerror="this.src='https://via.placeholder.com/500?text={{ product.name }}'">
        </div>

        <!-- Información del Producto -->
        <div class="product-info-section">
            <a href="#" class="product-category-badge">{{ product.category.name }}</a>
            
            <h1 class="product-detail-title">{{ product.name }}</h1>

            <div class="product-detail-rating">
                <span class="rating-stars">
                    {% for i in "12345" %}
                        {% if forloop.counter <= product.rating|floatformat:"0" %}
                            <i class="fas fa-star"></i>
                        {% else %}
                            <i class="far fa-star"></i>
                        {% endif %}
                    {% endfor %}
                </span>
                <span class="rating-number">{{ product.rating }}</span>
                <span class="rating-count">{{ product.reviews_count }} {% trans "calificaciones" %}</span>
            </div>

            <div class="divider"></div>

            <!-- Precio -->
            <div class="product-detail-price">
                <div class="price-label">{% trans "Precio:" %}</div>
                <div class="current-price">
                    <span class="price-symbol">$</span>
                    <span>{{ product.price }}</span>
                    {% if product.original_price %}
                    <span class="original-price-detail">${{ product.original_price }}</span>
                    {% endif %}
                    {% if product.discount_percentage > 0 %}
                    <span class="savings-badge">-{{ product.discount_percentage }}%</span>
                    {% endif %}
                </div>
            </div>

            <!-- Prime -->
            {% if product.is_prime %}
            <div class="prime-section">
                <div class="prime-logo">
                    <i class="fas fa-bolt"></i> Prime
                </div>
                <div class="prime-benefits">
                    {% trans "Envío GRATIS el" %} <strong>{% trans "mañana" %}</strong><br>
                    {% trans "Haz tu pedido en las próximas" %} <strong>4 {% trans "horas" %}</strong>
                </div>
            </div>
            {% endif %}

            <div class="divider"></div>

            <!-- Descripción -->
            <div class="product-description">
                <h2 class="description-title">{% trans "Acerca de este producto" %}</h2>
                <p class="description-text">{{ product.description }}</p>
            </div>

            <!-- Características -->
            <div class="product-features">
                <h2 class="description-title">{% trans "Características principales" %}</h2>
                <ul class="features-list">
                    <li>{% trans "Producto de alta calidad" %}</li>
                    <li>{% trans "Garantía del fabricante incluida" %}</li>
                    {% if product.is_prime %}
                    <li>{% trans "Elegible para envío Prime" %}</li>
                    {% endif %}
                    <li>{% trans "Envío disponible a todo el país" %}</li>
                    {% if product.stock > 10 %}
                    <li>{% trans "Stock disponible para envío inmediato" %}</li>
                    {% endif %}
                </ul>
            </div>
        </div>

        <!-- Caja de Compra -->
        <div class="buy-box">
            <div class="buy-box-price">
                ${{ product.price }}
            </div>

            {% if product.stock > 0 %}
            <div class="stock-status in-stock">
                <i class="fas fa-check-circle"></i> {% trans "En stock" %}
            </div>
            
            <div class="delivery-info">
                <div style="margin-bottom: 5px;">
                    <i class="fas fa-truck"></i> 
                    <strong>{% trans "Envío GRATIS" %}</strong>
                </div>
                <div>
                    {% trans "Llega" %}: <strong>{% trans "Mañana" %}</strong>
                </div>
            </div>

            <div class="quantity-selector">
                <label for="quantity">{% trans "Cantidad:" %}</label>
                <select id="quantity" name="quantity">
                    {% for i in "12345678910" %}
                    <option value="{{ forloop.counter }}">{{ forloop.counter }}</option>
                    {% endfor %}
                </select>
            </div>

            <button class="btn-add-cart">
                <i class="fas fa-shopping-cart"></i> {% trans "Agregar al carrito" %}
            </button>

            <button class="btn-buy-now">
                {% trans "Comprar ahora" %}
            </button>

            <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #e7e7e7; font-size: 13px; color: #565959;">
                <div style="margin-bottom: 8px;">
                    <i class="fas fa-lock"></i> {% trans "Transacción segura" %}
                </div>
                <div style="margin-bottom: 8px;">
                    <i class="fas fa-undo"></i> {% trans "Devoluciones fáciles" %}
                </div>
                <div>
                    <i class="fas fa-shipping-fast"></i> {% trans "Envíos a todo el país" %}
                </div>
            </div>

            {% else %}
            <div class="stock-status out-of-stock">
                <i class="fas fa-times-circle"></i> {% trans "Producto agotado" %}
            </div>
            <p style="font-size: 14px; color: #565959; margin-top: 10px;">
                {% trans "Este producto no está disponible actualmente." %}
            </p>
            {% endif %}
        </div>
    </div>

    <!-- Productos Relacionados -->
    {% if related_products %}
    <div class="related-products-section">
        <h2 class="related-title">{% trans "Productos relacionados" %}</h2>
        <div class="related-grid">
            {% for related in related_products %}
            <a href="{% url 'shop:product_detail' related.slug %}" class="related-product-card">
                <img src="{% if related.image %}{{ related.image.url }}{% else %}https://via.placeholder.com/200{% endif %}" 
                     alt="{{ related.name }}" 
                     class="related-product-image"
                     onerror="this.src='https://via.placeholder.com/200?text=Producto'">
                
                <div class="related-product-name">{{ related.name }}</div>
                
                <div class="related-product-price">${{ related.price }}</div>
                
                {% if related.is_prime %}
                <div style="color: #00a8e1; font-size: 12px; margin-top: 5px;">
                    <i class="fas fa-bolt"></i> Prime
                </div>
                {% endif %}
            </a>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
